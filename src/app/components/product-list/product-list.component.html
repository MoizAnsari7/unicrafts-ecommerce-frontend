<div class="container py-5">
  <h1 *ngIf="products.length > 0 " class="text-center mb-4 fw-bold text-primary">Our Exclusive Products</h1>

  <!-- Show message if no products are available -->
  <div *ngIf="!products || products.length === 0" class="text-center">
    <h2 class=" text-center mb-4  text-primary">Loading Products...</h2>
    <!-- Loading Spinner -->
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>

  </div>

  <div *ngIf="products.length > 0 " class="row mb-4">
    <div class="col-md-6 mx-auto">
      <input
        type="text"
        class="form-control"
        placeholder="Search products by name or description..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearch()"
      />
    </div>
    <div class="col-md-6 mx-auto mt-3 mt-md-0">
      <select
        class="form-select"
        [(ngModel)]="selectedCategory"
        (change)="onFilter()"
      >
        <option value="">All Categories</option>
        <option *ngFor="let category of categories" [value]="category">
          {{ category }}
        </option>
      </select>
    </div>
  </div>



  <!-- Products Grid -->
  <div *ngIf="!loading && filteredProducts && filteredProducts.length > 0" class="row g-4">
    <div
      class="col-lg-3 col-md-4 col-sm-6"
      *ngFor="let product of filteredProducts"
    >
      <div class="card product-card shadow-sm">
        <!-- Product Card Content -->
        <div class="card-img-container">
          <img
            [src]="product.imagePath || 'assets/placeholder.png'"
            class="card-img-top img-fluid"
            alt="{{ product.name || 'Unnamed Product' }}"
          />
        </div>
        <div class="card-body text-center">
          <h5 class="card-title">{{ product.name || 'Unnamed Product' }}</h5>
          <p class="card-text text-muted">
            {{ product.description | slice: 0:50 }}...
          </p>
          <h6 class="text-success fw-bold">₹{{ product.price || 'N/A' }}</h6>
        </div>
        <div class="card-footer text-center">
          <button
            class="btn btn-primary btn-sm rounded-pill me-2"
            [routerLink]="['/product', product._id]"
          >
            View Details
          </button>
          <button
            class="btn btn-outline-success btn-sm rounded-pill"
            (click)="addToCart(product)"
          >
            {{ addedToCart[product._id] ? 'Added' : 'Add to Cart' }}
          </button>
        </div>
      </div>
    </div>
  </div>
  


</div>

<!-- Modal for Product Details -->





<div *ngIf="selectedProduct" class="modal fade" id="productModals" tabindex="-1" aria-labelledby="productModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productModalLabel">
          {{ selectedProduct?.name }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <img [src]="selectedProduct?.image || 'assets/placeholder.png'" alt="{{ selectedProduct?.name }}"
          class="img-fluid mb-3" style="max-height: 250px; object-fit: contain;" />
        <p class="text-muted">{{ selectedProduct?.description }}</p>
        <h6 class="text-success fw-bold">
          Price: ₹{{ selectedProduct?.price }}
        </h6>

        <!-- Quantity control -->
        <div class="d-flex justify-content-center align-items-center mt-3">
          <button class="btn btn-secondary btn-sm" (click)="decrementQuantity()">
            -
          </button>
          <span class="mx-3">{{ quantities[selectedProduct._id] || 1 }}</span>
          <button class="btn btn-secondary btn-sm" (click)="incrementQuantity()">
            +
          </button>
        </div>

        <!-- Total Price -->
        <h6 class="mt-3 text-primary fw-bold">
          Total: ₹{{ selectedProduct?.price * (quantities[selectedProduct._id] || 1) }}
        </h6>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
          Close
        </button>
        <button class="btn btn-primary btn-sm" (click)="addToCart(selectedProduct)">
          {{ addedToCart[selectedProduct._id] ? 'Added' : 'Add to Cart' }}
        </button>
      </div>
    </div>
  </div>
</div>